#!/usr/bin/env python
# -*- coding:UTF-8

#Private-Key: (2048 bit)
#modulus:
#    00:bc:d5:77:c7:94:2b:03:7a:da:6c:26:50:14:59:
#    79:13:2e:69:23:52:8d:74:c6:e4:4c:2e:b1:33:8d:
#    23:6b:5a:74:bc:46:de:a3:56:58:53:f7:c6:d1:59:
#    ac:a5:7b:d4:4c:f6:51:1c:78:29:fc:4e:cb:6e:59:
#    12:a3:21:23:76:ad:bc:d4:12:91:22:7f:3e:d5:45:
#    c2:56:92:58:62:f3:4c:66:f7:5f:c1:3a:e2:e7:16:
#    6f:c6:ee:38:d9:43:30:16:a1:65:9d:65:5c:72:c8:
#    99:3a:b4:8f:25:73:e0:0c:8b:21:6c:75:f1:e9:c1:
#    fb:c4:d7:e7:52:1e:6e:4f:f7:73:ff:71:47:ee:3d:
#    24:0a:73:c1:dd:6f:94:a2:e0:9e:c5:08:b2:c5:fd:
#    6f:7d:14:49:e5:78:0f:75:23:5a:a7:63:b0:06:e2:
#    d7:70:4f:64:6d:0f:47:5f:46:d3:f0:ef:d5:63:c4:
#    d4:3b:be:70:b5:c5:4b:1c:4f:3b:21:51:4b:65:38:
#    73:5c:79:f8:1c:5d:57:65:f1:f2:37:53:5a:aa:0e:
#    f1:b5:8c:34:36:61:b4:0b:d5:a2:c3:19:dd:d5:d2:
#    f5:f1:55:8b:46:0d:36:b7:98:44:df:e8:0d:33:f1:
#    f0:b7:ec:c7:f4:6a:60:dc:4b:dd:87:14:f4:6f:de:
#    6a:cb
#publicExponent: 65537 (0x10001)
#privateExponent:
#    38:5b:dd:ec:0b:24:eb:5c:f7:63:df:eb:76:a7:5d:
#    a3:83:ee:8d:44:4e:43:d4:38:bf:24:10:6f:3a:68:
#    9f:d9:d7:8d:79:f9:68:f6:94:56:3b:55:73:96:38:
#    19:0b:e4:49:34:1a:f1:4c:4b:fb:a9:e8:bd:7e:88:
#    39:77:e2:85:c1:44:e2:66:c8:3a:6b:8f:ed:47:6c:
#    c1:39:dc:77:6b:f6:19:a5:2b:47:18:b4:30:14:5a:
#    38:1d:51:8a:46:ab:4b:95:d0:26:31:e2:6d:bf:c1:
#    3b:ec:37:ed:0d:b0:89:0d:dd:63:e9:af:d1:fc:bb:
#    8f:fc:80:65:d9:ff:42:8e:2d:28:40:8d:de:cc:f4:
#    04:19:d5:4e:f7:40:c1:b5:b7:cf:85:80:56:52:d6:
#    66:bd:08:6d:2b:dd:39:7b:ab:cf:ec:9d:3b:53:d7:
#    32:07:33:b6:29:b7:3b:88:f4:00:b7:3d:8d:6f:56:
#    21:77:8e:22:77:66:a3:94:33:d0:d4:b9:5d:f4:d2:
#    c2:59:b6:2c:e3:57:c2:9a:e4:83:48:4b:65:4c:d4:
#    ff:15:a5:9b:78:6a:0a:a3:6a:06:40:20:aa:9d:92:
#    7d:8b:3d:03:ba:ad:f0:e1:10:42:3e:7e:86:e4:2a:
#    4f:dd:bf:2f:b4:cc:34:c3:97:2b:cd:1e:85:85:46:
#    81
#prime1:
#    00:de:58:f6:24:2b:e4:79:c5:c1:0c:ed:57:e6:c5:
#    c9:f9:ee:b0:1e:cc:c8:59:33:21:50:59:d4:87:70:
#    f3:e9:43:77:9d:de:63:5d:f6:c1:70:4c:62:f4:b6:
#    08:b1:34:a6:44:43:cc:7e:6b:94:f3:1b:28:2f:f1:
#    8d:c1:26:e0:c2:e4:db:bd:d7:58:2c:fc:b4:21:a9:
#    95:2d:0e:33:93:46:1f:b0:be:0b:1d:eb:ab:53:dc:
#    d8:58:ca:17:a3:02:c1:1e:5f:01:55:9b:ac:6c:92:
#    94:8b:a2:1a:2b:6a:b6:54:d9:b8:99:f5:d5:5a:6c:
#    08:b9:89:0a:34:fa:54:40:49
#prime2:
#    00:d9:69:fe:0b:29:8c:09:a3:b1:38:f5:5f:67:98:
#    51:77:a4:3a:6c:de:77:68:40:45:7d:f7:6d:5e:46:
#    3d:d2:9c:e0:11:37:74:dd:cf:03:75:e3:c4:f6:59:
#    3f:30:53:3a:32:b9:d1:f7:91:ca:01:9b:cc:35:4d:
#    cb:53:97:47:40:53:5d:03:88:f2:90:b7:ab:a9:75:
#    c1:ec:dd:fd:23:aa:65:a4:b2:ad:f1:86:bb:bf:87:
#    49:a9:55:f5:0d:23:4b:ad:20:3b:5c:86:27:99:83:
#    fe:5e:6b:93:72:85:3e:bb:f5:8d:4b:73:10:a0:f5:
#    dd:d7:40:ae:94:13:cd:3a:73
#exponent1:
#    00:9a:db:42:b2:f6:8e:ed:f0:b8:ff:93:de:00:b0:
#    08:77:b5:b1:9c:01:ec:17:93:f0:c3:d1:8c:9f:b8:
#    1f:68:7a:c0:b8:86:c6:96:0e:e1:b2:a0:c0:da:c6:
#    5d:4f:6d:e7:ce:eb:99:65:02:f0:7e:50:8f:b0:b4:
#    7f:91:e2:cd:ef:6f:0d:4c:2e:cb:0e:aa:01:9a:e0:
#    4d:31:50:0e:c3:a7:b7:32:95:69:90:b1:2e:65:fe:
#    0d:ff:e8:e0:85:7b:c9:9c:a9:76:78:75:2f:a5:7e:
#    81:4e:ae:db:a3:19:73:5b:ad:37:50:a3:52:b0:e3:
#    45:40:53:1d:74:c0:54:25:61
#exponent2:
#    05:e7:af:12:b6:8a:2b:28:db:03:65:06:b6:55:98:
#    c0:db:21:0b:1b:ef:ba:51:24:92:0b:4a:59:29:27:
#    3c:b5:2e:10:c9:a4:ce:f1:74:72:9b:41:1a:3f:ca:
#    4b:91:b7:1e:f1:95:16:58:4b:58:47:d7:00:0b:a0:
#    de:20:59:bb:11:88:91:34:03:02:93:3a:82:5b:c4:
#    6c:9e:8a:e5:91:17:39:a5:f0:bb:82:a1:4e:ce:69:
#    dd:c3:8b:e8:53:71:16:be:ad:5e:11:f6:b9:60:b0:
#    63:f8:20:05:18:41:5f:f1:87:68:e9:33:26:6c:07:
#    1e:75:8f:48:4e:51:60:a9
#coefficient:
#    00:93:78:e6:22:70:dc:0e:c1:9e:11:00:27:51:4b:
#    9d:3a:cf:94:22:c7:fb:d1:e6:43:1e:0a:19:37:ec:
#    4f:70:5f:26:78:7e:3d:8a:79:80:a3:66:56:59:d0:
#    bd:0d:4a:19:88:f0:36:06:c9:8e:89:fe:89:69:b1:
#    c1:1b:10:32:4a:ce:e4:e5:55:70:45:f5:bf:44:78:
#    60:ae:50:9d:ba:ba:dc:1e:26:63:f9:e5:58:4c:c1:
#    d1:f7:6b:ad:dc:92:ed:44:8d:da:ca:0b:ac:c7:68:
#    86:27:15:be:ed:f6:fd:a4:36:15:c8:a0:d8:d8:56:
#    69:24:d0:e9:4f:42:7d:18:a2
#
#
#
modulus=0x00bcd577c7942b037ada6c2650145979132e6923528d74c6e44c2eb1338d236b5a74bc46dea3565853f7c6d159aca57bd44cf6511c7829fc4ecb6e5912a3212376adbcd41291227f3ed545c256925862f34c66f75fc13ae2e7166fc6ee38d9433016a1659d655c72c8993ab48f2573e00c8b216c75f1e9c1fbc4d7e7521e6e4ff773ff7147ee3d240a73c1dd6f94a2e09ec508b2c5fd6f7d1449e5780f75235aa763b006e2d7704f646d0f475f46d3f0efd563c4d43bbe70b5c54b1c4f3b21514b6538735c79f81c5d5765f1f237535aaa0ef1b58c343661b40bd5a2c319ddd5d2f5f1558b460d36b79844dfe80d33f1f0b7ecc7f46a60dc4bdd8714f46fde6acb
publicExponent = 0x10001
privateExponent=0x385bddec0b24eb5cf763dfeb76a75da383ee8d444e43d438bf24106f3a689fd9d78d79f968f694563b55739638190be449341af14c4bfba9e8bd7e883977e285c144e266c83a6b8fed476cc139dc776bf619a52b4718b430145a381d518a46ab4b95d02631e26dbfc13bec37ed0db0890ddd63e9afd1fcbb8ffc8065d9ff428e2d28408ddeccf40419d54ef740c1b5b7cf85805652d666bd086d2bdd397babcfec9d3b53d7320733b629b73b88f400b73d8d6f5621778e227766a39433d0d4b95df4d2c259b62ce357c29ae483484b654cd4ff15a59b786a0aa36a064020aa9d927d8b3d03baadf0e110423e7e86e42a4fddbf2fb4cc34c3972bcd1e85854681
prime1=0x00de58f6242be479c5c10ced57e6c5c9f9eeb01eccc85933215059d48770f3e943779dde635df6c1704c62f4b608b134a64443cc7e6b94f31b282ff18dc126e0c2e4dbbdd7582cfcb421a9952d0e3393461fb0be0b1debab53dcd858ca17a302c11e5f01559bac6c92948ba21a2b6ab654d9b899f5d55a6c08b9890a34fa544049
prime2=0x00d969fe0b298c09a3b138f55f67985177a43a6cde776840457df76d5e463dd29ce0113774ddcf0375e3c4f6593f30533a32b9d1f791ca019bcc354dcb53974740535d0388f290b7aba975c1ecddfd23aa65a4b2adf186bbbf8749a955f50d234bad203b5c86279983fe5e6b9372853ebbf58d4b7310a0f5ddd740ae9413cd3a73
exponent1=0x009adb42b2f68eedf0b8ff93de00b00877b5b19c01ec1793f0c3d18c9fb81f687ac0b886c6960ee1b2a0c0dac65d4f6de7ceeb996502f07e508fb0b47f91e2cdef6f0d4c2ecb0eaa019ae04d31500ec3a7b732956990b12e65fe0dffe8e0857bc99ca97678752fa57e814eaedba319735bad3750a352b0e34540531d74c0542561
exponent2=0x05e7af12b68a2b28db036506b65598c0db210b1befba5124920b4a5929273cb52e10c9a4cef174729b411a3fca4b91b71ef19516584b5847d7000ba0de2059bb118891340302933a825bc46c9e8ae5911739a5f0bb82a14ece69ddc38be8537116bead5e11f6b960b063f8200518415ff18768e933266c071e758f484e5160a9
coefficient=0x009378e62270dc0ec19e110027514b9d3acf9422c7fbd1e6431e0a1937ec4f705f26787e3d8a7980a3665659d0bd0d4a1988f03606c98e89fe8969b1c11b10324acee4e5557045f5bf447860ae509dbabadc1e2663f9e5584cc1d1f76baddc92ed448ddaca0bacc768862715beedf6fda43615c8a0d8d8566924d0e94f427d18a2

# modulus publicExponent privateExponent prime1 prime2  exponent1  exponent2  coefficient



def modInverse(a, m) :
    a = a % m;
    for x in range(1, m) :
        if ((a * x) % m == 1) :
            return x
    return 1

## Driver Program
#a = 2
#m = 17
#print(modInverse(a, m))

#https://crypto.stackexchange.com/questions/6593/what-data-is-saved-in-rsa-private-key
#  Modulus (n=pq)
#  Public exponent (e)
#  Private exponent (d=e−1\mathchoice(modϕ(n)))
#  First prime (p)
#  Second prime (q)
#  First exponent, used for Chinese remainder theorem (dP=d\mathchoice(modp−1))
#  Second exponent, used for CRT (dQ=d\mathchoice(modq−1))
#  Coefficient, used for CRT (qinv=q−1\mathchoice(modp))

# https://www.di-mgt.com.au/crt_rsa.html
# The Chinese Remainder Theorem - special case
# A special case of the Chinese Remainder Theorem (CRT) can be written as follows.
# 
# Theorem. Let p and q be distinct primes and n = p.q. For any pair (x1, x2) where 0 ≤ x1 < p and 0 ≤ x2 < q, there is a unique number x where 0 ≤ x < n such that
#    x1 = x mod p, and 
#    x2 = x mod q.
# So any integer x (0 ≤ x < n) can be expressed uniquely in its CRT representation (x1, x2).

# modulus publicExponent privateExponent prime1 prime2  exponent1  exponent2  coefficient


print modulus==(prime1*prime2)

phai_n = (prime1-1) * (prime2-1)

print (publicExponent*privateExponent) % phai_n

print (publicExponent*exponent1) % (prime1-1) 

print (publicExponent*exponent2) % (prime2-1) 

print (coefficient*prime2) % (prime1) 
